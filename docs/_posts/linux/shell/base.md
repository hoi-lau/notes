# shell基础

## shell变量

| 参数处理 | 说明                                                         |
| :------- | :----------------------------------------------------------- |
| $#       | 传递到脚本的参数个数                                         |
| $*       | 以一个单字符串显示所有向脚本传递的参数。 如"$*"用「"」括起来的情况、以"$1 $2 … $n"的形式输出所有参数。$0, 当前脚本名 |
| $$       | 脚本运行的当前进程ID号                                       |
| $!       | 后台运行的最后一个进程的ID号                                 |
| $@       | 与$*相同，但是使用时加引号，并在引号中返回每个参数。 如"$@"用「"」括起来的情况、以"$1" "$2" … "$n" 的形式输出所有参数。 |
| $-       | 显示Shell使用的当前选项，与set命令功能相同。                 |
| $?       | 显示最后命令的退出状态。0表示没有错误，其他任何值表明有错误。 |

## history

查看历史命令

options:

- -c 清空历史命令
- -w 将缓存中的历史命令写入文件

默认保存1000条,~/.bash_history

/etc/profile  HISTSIZE

- 使用 ` !n`执行第n条历史命令
- 使用`!!`执行上一条命令
- `!str_prefix`符合匹配的最近一条命令

## 命令执行顺序

1. 绝对路径或者相对路径执行的命令
2. 别名执行的命令
3. bash内部命令
4. 环境变量定义的命令

## Bash常用快捷键

| 快捷键   | 作用               |
| -------- | ------------------ |
| Ctrl + A | 光标移动到行首     |
| Ctrl + E | 光标移动到行尾     |
| Ctrl + C | 终止当前命令       |
| Ctrl + L | 清屏 相当于 clear  |
| Ctr + U  | 剪切光标之前的命令 |
| Ctrl + K | 剪切光标之后的命令 |
| Ctrl + R | 从历史命令中搜索   |
| Ctrl + D|退出当前终端|
|Ctrl + S |暂停屏幕输出|
|Ctrl + Q | 恢复屏幕输出|

## 标准输入输出

| 设备   | 设备文件名  | 文件描述符 | 类型         |
| ------ | ----------- | ---------- | ------------ |
| 键盘   | /dev/stdin  | 0          | 标准输入     |
| 显示器 | /dev/sdtout | 1          | 标准输出     |
| 显示器 | /dev/sdterr | 2          | 标准错误输出 |

## 输出重定向

命令>文件

```shell
# 记录正确输出
# 记录ls内容到ls.log
ls>ls.log
# 原有文件上追加
ls>>ls.log

# 记录错误输出
# 错误输出重定向
lsll 2> lsll.log
lsll 2>> lsll.log

# 同时记录正确和错误输出
# 命令 > 文件 2>&1  覆盖
# 命令 >> 文件 2>&1 追加
ls &> ls.log

# 正确错误分开保存
# 命令>>文件1 2>>文件2
```

## 输入重定向

wc命令

```shell
# 统计文件 行数 单词数量 字符数
wc < file
```

## 多命令顺序执行

| 多命令执行符 | 格式             | 作用                               |
| ------------ | ---------------- | ---------------------------------- |
| ;            | 命令1 ; 命令2    | 多个命令顺序执行,没有逻辑联系      |
| &&           | 命令1 && 命令2   | 逻辑与,命令1错误执行,命令2不会执行 |
| \|\|         | 命令1 \|\| 命令2 | 逻辑或,命令1错误执行,命令2才会执行 |

## 管道符 | 

命令1 | 命名2

**命令1的输出作为命令2的输入,命令1必须有正确输出**

## 通配符

| 通配符 | 作用                                 |
| ------ | ------------------------------------ |
| ?      | 匹配任意一个字符                     |
| *      | 0或者多个字符                        |
| []     | eg:[abcd]匹配abcd任意一个字符. [a-z] |

## 预定义变量

| 变量 | 作用                                         |
| ---- | -------------------------------------------- |
| $?   | 最后一次执行命令的返回状态.只有0代表正确执行 |
| $$   | 当前进程id                                   |
| $!   | 后台运行的最后一个程序的pid                  |

## 接受键盘输入

read命令 

```shell
# 变量赋值
# read [options] 变量
read -s -t 30 -n 2 -p "提示信息" 变量
# -s 隐藏输入
# -t 指定等待时间, 秒数
# -n 指定输入字符数
# -p 提示信息
```

## 流程控制

### if else

```shell
if [condition]
  then
elif
  then
else
fi
```

### case

```shell
case $var in
  "1")
    echo "1"
    ;;
  "2")
    echo "2"
    ;;
  *)
    ;;
esac
```

## 循环

for

```shell
for i in 1 2 3 4
  do
    ...
  done
  
for (( i=1;i<100;i=i+1 ))
  do
  done
  
while condition
do
done
```

## 获取当前脚本绝对路径

```shell
SHELL_PATH=$(dirname $(readlink -f "$0"))
```

